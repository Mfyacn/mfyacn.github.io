[{"content":"注意：本文仅记录使用Github Actions自动部署Hugo到Github Pages和虚拟主机上，不包含Hugo博客搭建（Hugo博客搭建的教程在网络上已经很多了）。\n一、准备工作 1.准备好两个Github库，分别为Hugo仓库(私有)和Github Pages仓库(公共)，Github Pages仓库创建需要以 *.github.io 命名(*为你的Github用户名)，如下图。 2.在 GitHub 账户下 Setting \u0026gt; Developer setting \u0026gt; Personal access tokens 下创建一个 Token，过期时间选No expiration，权限勾选repo和workflow，如下图。 3.将本地博客文件Push到博客文件仓库，之后在Hugo仓库的 Settings \u0026gt; Secrets and variables \u0026gt; Actions 内点击New repository secret，依据下表填写。\nName Secret PERSONAL_TOKEN 填写Github Token FTP_HOST 填写虚拟主机的IP/域名 FTP_USERNAME 填写虚拟主机FTP用户名 FTP_PASSWORD 填写虚拟主机FTP密码 FTP_PORT 填写虚拟主机FTP端口 填写后如下图。 二、部署Github Actions 4.在Hugo仓库内创建目录 .github/workflows ，在该目录内创建 deploy.yml文件，如下图。 5.在 deploy.yml 文件内填写如下代码并根据提示修改。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 name: deploy on: push: workflow_dispatch: schedule: # Runs everyday at 8:00 AM - cron: \u0026#34;0 0 * * *\u0026#34; jobs: build: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v2 with: submodules: true fetch-depth: 0 - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#34;latest\u0026#34; extended: true - name: Build Web run: hugo - name: Deploy Hugo to Github Pages uses: peaceiris/actions-gh-pages@v3 with: PERSONAL_TOKEN: ${{ secrets.PERSONAL_TOKEN }} EXTERNAL_REPOSITORY: mfyacn/mfyacn.github.io #替换为你的Github Pages仓库地址。 PUBLISH_BRANCH: master PUBLISH_DIR: ./public commit_message: ${{ github.event.head_commit.message }} #cname: blog.mfya.cn #如果你打算使用自己的域名的话先在https://github.com/settings/pages添加并验证域名后去掉cname前面的#并在冒号后填写你的域名。 - name: Deploy Hugo to FTP uses: SamKirkland/FTP-Deploy-Action@4.3.0 with: server: ${{ secrets.ftp_host }} username: ${{ secrets.ftp_username }} password: ${{ secrets.ftp_password }} port: ${{ secrets.ftp_port }} local-dir: ./public/ server-dir: WEB/ #填写你的虚拟主机内网站文件目录，如/wwwroot 三、部署结果 6.修改完成 deploy.yml 后，Github Actions会自动运行并将Hugo生成在Public文件夹下的静态文件上传到Github Pages和虚拟主机内，如下图。 至此，利用Github Actions自动部署Hugo博客到Github Pages和虚拟主机就完成了！\n","permalink":"https://blog.mfya.cn/posts/play/hugo-workflows/","summary":"自动部署Hugo到Github Pages和虚拟主机，解放双手。","title":"利用Github Actions自动部署Hugo博客"}]